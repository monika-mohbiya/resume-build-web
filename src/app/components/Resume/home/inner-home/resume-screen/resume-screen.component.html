<div class="resume-page">

    <!-- ================= TOP ACTIONS ================= -->
    <div class="top-actions">
        <div class="left-actions">

            <!-- Templates -->
            <div class="hover-wrapper" (mouseenter)="showTemplatePopup = true" (mouseleave)="showTemplatePopup = false">

                <button class="btn-outline">⬛⬜ Templates</button>

                @if(showTemplatePopup){
                <div class="template-popup">
                    <div class="color-row">
                        <span class="color-dot black" (click)="changeTheme('black')"></span>
                        <span class="color-dot brown" (click)="changeTheme('brown')"></span>
                        <span class="color-dot green" (click)="changeTheme('green')"></span>
                        <span class="color-dot blue" (click)="changeTheme('blue')"></span>
                        <span class="color-dot purple" (click)="changeTheme('purple')"></span>
                        <span class="color-dot pink" (click)="changeTheme('pink')"></span>
                    </div>
                </div>
                }
            </div>

            <button class="btn-outline" (click)="openMngSec()">Manage Sections</button>
            <button class="btn-outline" routerLink="/resume-form">Edit</button>
        </div>

        <button class="btn-primary" (click)="exportPDF()">⬇ Download Resume</button>
    </div>

    <!-- ================= RESUME PREVIEW ================= -->

    <app-resume-preview [selectedComponent]="selectedComponent" [resumeData]="resumeData" [sections]="sections"
        [selectColor]="selectedTemplateColor">
    </app-resume-preview>

</div>


<ng-template #manageSectionsTpl>
    <div class="popup-overlay">
        <div class="manage-panel">
            <div class="panel-header">
                <h3>Manage Sections</h3>
                <button (click)="closeManage()">✕</button>
            </div>

            <div class="section-list">
                @for(section of sections; track section.key){
                <div class="section-item">
                    <span>{{ section.label }}</span>
                    <input type="checkbox" [(ngModel)]="section.enabled" />
                </div>
                }
            </div>

            <button class="add-btn" (click)="openNamePopup()">
                ➕ Add a Custom Section
            </button>
        </div>
    </div>
</ng-template>


@if(showNamePopup){
<div class="popup-overlay">
    <div class="popup-box">
        <h3>Name your new section</h3>
        <input [(ngModel)]="newSectionName" placeholder="Enter section name" />

        <div class="actions">
            <button (click)="closeNamePopup()">Dismiss</button>
            <button (click)="saveSectionName()">Save</button>
        </div>
    </div>
</div>
}

@if(showEditorPopup){
<div class="popup-overlay">
    <div class="popup-large">
        <div class="header">
            <h3>{{ activeSection?.label }}</h3>
            <button (click)="closeEditorPopup()">✕</button>
        </div>

        <textarea rows="8" [(ngModel)]="activeSection!.description" placeholder="Start typing..."></textarea>

        <div class="actions">
            <button (click)="closeEditorPopup()">Cancel</button>
            <button (click)="saveCustomSection()">Save</button>
        </div>
    </div>
</div>
}